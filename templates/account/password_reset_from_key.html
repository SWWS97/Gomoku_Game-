{% extends "account/base_auth.html" %}
{% block title %}새 비밀번호 설정 – 오목조목{% endblock %}
{% block content %}
{% if token_fail %}
<div class="error-icon">
  <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="32" cy="32" r="28" stroke="#c53030" stroke-width="4" fill="none"/>
    <path d="M22 22l20 20M42 22l-20 20" stroke="#c53030" stroke-width="4" stroke-linecap="round"/>
  </svg>
</div>

<h1>링크가 만료되었습니다</h1>
<p class="sub">비밀번호 재설정 링크가 유효하지 않습니다</p>

<div class="info-card error">
  <p>이 링크는 이미 사용되었거나 만료되었습니다.</p>
  <p>새로운 비밀번호 재설정 링크를 요청해주세요.</p>
</div>

<a href="{% url 'account_reset_password' %}" class="btn" style="display: block; text-align: center; text-decoration: none; margin-top: 20px;">
  다시 요청하기
</a>

{% else %}
<h1><span class="stone white"></span> 새 비밀번호 설정</h1>
<p class="sub">새로운 비밀번호를 입력해주세요</p>

<form method="post" action="{{ action_url }}">
  {% csrf_token %}

  <div class="row">
    <label for="id_password1">새 비밀번호</label>
    <input type="password" name="password1" id="id_password1" placeholder="새 비밀번호" required autofocus>
    {% if form.password1.errors %}
      <ul class="errorlist">
        {% for error in form.password1.errors %}
          <li>{{ error }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>

  <div class="row">
    <label for="id_password2">새 비밀번호 확인</label>
    <input type="password" name="password2" id="id_password2" placeholder="새 비밀번호 확인" required>
    {% if form.password2.errors %}
      <ul class="errorlist">
        {% for error in form.password2.errors %}
          <li>{{ error }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>

  <div class="password-hint">
    <p>비밀번호는 다음 조건을 만족해야 합니다:</p>
    <ul>
      <li>8자 이상</li>
      <li>숫자 포함</li>
      <li>너무 단순하지 않은 비밀번호</li>
    </ul>
  </div>

  <button class="btn" type="submit">비밀번호 변경</button>
</form>
{% endif %}

<style>
  .error-icon, .success-icon {
    text-align: center;
    margin-bottom: 16px;
  }
  .info-card {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 12px;
    padding: 16px 20px;
    margin-top: 16px;
    font-size: 14px;
    line-height: 1.6;
  }
  .info-card.error {
    background: #fff5f5;
    border-color: #feb2b2;
  }
  .info-card p {
    margin: 0 0 8px;
  }
  .info-card p:last-child {
    margin-bottom: 0;
  }
  .password-hint {
    background: #f0f4f0;
    border-radius: 10px;
    padding: 12px 16px;
    margin: 16px 0;
    font-size: 13px;
  }
  .password-hint p {
    margin: 0 0 6px;
    font-weight: 500;
  }
  .password-hint ul {
    margin: 0;
    padding-left: 18px;
  }
  .password-hint li {
    margin: 3px 0;
    color: #555;
  }
  h1 {
    text-align: center;
  }
  .sub {
    text-align: center;
  }
</style>
{% endblock %}